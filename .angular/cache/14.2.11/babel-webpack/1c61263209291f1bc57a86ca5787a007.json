{"ast":null,"code":"import _asyncToGenerator from \"/home/claudiopcwork/Desktop/Desarrollo FULLSTACK/Tienda Electronica/tienda-electronica-admin/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { FormControl, Validators } from \"@angular/forms\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/authorization.service\";\nimport * as i2 from \"src/app/services/app-logs.service\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"@angular/router\";\nexport class LoginComponent {\n  constructor(service, appLogsService, formBuilder, navigationApp) {\n    var _a;\n\n    this.service = service;\n    this.appLogsService = appLogsService;\n    this.formBuilder = formBuilder;\n    this.navigationApp = navigationApp;\n    this.payload = [];\n    this.loginForm = this.formBuilder.group({\n      usernameInput: new FormControl(\"\", Validators.required),\n      passwordInput: new FormControl(\"\", Validators.required)\n    });\n    this.credentials = {\n      password: \"\",\n      username: \"\"\n    };\n    const dateSys = new Date();\n    dateSys.toLocaleDateString('en-US');\n    this.appLogsNew = {\n      eventType: \"Autenticacion\",\n      eventDescription: \"Intento de autenticacion en el app administrador por: \" + ((_a = this.loginForm.get(\"usernameInput\")) === null || _a === void 0 ? void 0 : _a.value),\n      eventDate: `Fecha: ${dateSys.getDate()}/${dateSys.getMonth()}/${dateSys.getFullYear()} Hora: ${dateSys.getHours()} ${dateSys.getMinutes()}`\n    };\n  }\n\n  GenerateAuth() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      var _a, _b;\n\n      _this.appLogsService.PostAppLogs(_this.appLogsNew).subscribe(result => {\n        console.log(result);\n      });\n\n      _this.credentials = {\n        username: (_a = _this.loginForm.get(\"usernameInput\")) === null || _a === void 0 ? void 0 : _a.value,\n        password: (_b = _this.loginForm.get(\"passwordInput\")) === null || _b === void 0 ? void 0 : _b.value\n      };\n\n      _this.service.PostAuthorization(_this.credentials).subscribe(result => {\n        _this.payload.pop();\n\n        _this.payload.push(result);\n\n        localStorage.setItem(\"payload\", JSON.stringify(_this.payload));\n\n        switch (_this.payload[0].jwt) {\n          case \"USER NOT FOUND\":\n            alert(\"THIS USER WAS NOT FOUND OR YOU ENTER BAD CREDENTIALS! PLEASE TRY AGAIN\");\n            break;\n\n          case \"NO AUTHORIZED\":\n            alert(\"BAD CREDENTIALS OR USER ACCOUNT INACTIVE, PLEASE TRY AGAIN\");\n            break;\n\n          default:\n            _this.navigationApp.navigateByUrl(\"/Profile\");\n\n        }\n      }, error => {\n        alert(error.error.error.message);\n      });\n    })();\n  }\n\n  ngOnInit() {}\n\n}\n\nLoginComponent.ɵfac = function LoginComponent_Factory(t) {\n  return new (t || LoginComponent)(i0.ɵɵdirectiveInject(i1.AuthorizationService), i0.ɵɵdirectiveInject(i2.AppLogsService), i0.ɵɵdirectiveInject(i3.FormBuilder), i0.ɵɵdirectiveInject(i4.Router));\n};\n\nLoginComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: LoginComponent,\n  selectors: [[\"app-login\"]],\n  decls: 18,\n  vars: 2,\n  consts: [[1, \"container\", \"bg-dark\"], [1, \"row\", \"justify-content-center\", \"align-items-center\", \"vh-100\"], [1, \"col-md-4\"], [1, \"card\"], [1, \"card-body\"], [1, \"card-title\", \"mb-4\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"mb-3\"], [\"for\", \"username\", 1, \"form-label\"], [\"type\", \"text\", \"id\", \"username\", \"name\", \"username\", \"placeholder\", \"Enter Username\", \"formControlName\", \"usernameInput\", \"required\", \"true\", 1, \"form-control\"], [\"for\", \"password\", 1, \"form-label\"], [\"type\", \"password\", \"id\", \"password\", \"name\", \"password\", \"placeholder\", \"Enter Password\", \"formControlName\", \"passwordInput\", \"required\", \"true\", 1, \"form-control\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", 3, \"disabled\"]],\n  template: function LoginComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"div\", 4)(5, \"h5\", 5);\n      i0.ɵɵtext(6, \"Iniciar Sesi\\u00F3n\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(7, \"form\", 6);\n      i0.ɵɵlistener(\"ngSubmit\", function LoginComponent_Template_form_ngSubmit_7_listener() {\n        return ctx.GenerateAuth();\n      });\n      i0.ɵɵelementStart(8, \"div\", 7)(9, \"label\", 8);\n      i0.ɵɵtext(10, \"Nombre de usuario\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(11, \"input\", 9);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(12, \"div\", 7)(13, \"label\", 10);\n      i0.ɵɵtext(14, \"Contrase\\u00F1a\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(15, \"input\", 11);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(16, \"button\", 12);\n      i0.ɵɵtext(17, \" Iniciar sesi\\u00F3n \");\n      i0.ɵɵelementEnd()()()()()()();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"formGroup\", ctx.loginForm);\n      i0.ɵɵadvance(9);\n      i0.ɵɵproperty(\"disabled\", ctx.loginForm.invalid);\n    }\n  },\n  dependencies: [i3.ɵNgNoValidate, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgControlStatusGroup, i3.RequiredValidator, i3.FormGroupDirective, i3.FormControlName],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJsb2dpbi5jb21wb25lbnQuY3NzIn0= */\"]\n});","map":{"version":3,"mappings":"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","names":["FormControl","Validators","LoginComponent","constructor","service","appLogsService","formBuilder","navigationApp","loginForm","group","usernameInput","required","passwordInput","credentials","password","username","dateSys","Date","toLocaleDateString","appLogsNew","eventType","eventDescription","get","_a","value","eventDate","getDate","getMonth","getFullYear","getHours","getMinutes","GenerateAuth","PostAppLogs","subscribe","result","console","log","_b","PostAuthorization","payload","pop","push","localStorage","setItem","JSON","stringify","jwt","alert","navigateByUrl","error","message","ngOnInit","i0","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["/home/claudiopcwork/Desktop/Desarrollo FULLSTACK/Tienda Electronica/tienda-electronica-admin/src/app/components/UserAccountsComponents/login/login.component.ts","/home/claudiopcwork/Desktop/Desarrollo FULLSTACK/Tienda Electronica/tienda-electronica-admin/src/app/components/UserAccountsComponents/login/login.component.html"],"sourcesContent":["import { HttpErrorResponse } from \"@angular/common/http\";\nimport { Component, OnInit } from \"@angular/core\";\n\nimport {\n  FormBuilder,\n  FormControl,\n  FormGroup,\n  Validators,\n} from \"@angular/forms\";\nimport { Router } from \"@angular/router\";\nimport { IAppLogs } from \"src/app/interfaces/AppLogs\";\nimport { IAuthorization } from \"src/app/interfaces/Authorization\";\nimport { IUserAccounts } from \"src/app/interfaces/UserAccounts\";\nimport { AppLogsService } from \"src/app/services/app-logs.service\";\nimport { AuthorizationService } from \"src/app/services/authorization.service\";\n@Component({\n  selector: \"app-login\",\n  templateUrl: \"./login.component.html\",\n  styleUrls: [\"./login.component.css\"],\n})\nexport class LoginComponent implements OnInit {\n  loginForm: FormGroup;\n  credentials: IAuthorization;\n  payload: IUserAccounts[] = [];\n  appLogsNew: IAppLogs;\n\n  constructor(\n    private service: AuthorizationService,\n    private appLogsService: AppLogsService,\n    private formBuilder: FormBuilder,\n    private navigationApp: Router\n  ) {\n    this.loginForm = this.formBuilder.group({\n      usernameInput: new FormControl(\"\", Validators.required),\n      passwordInput: new FormControl(\"\", Validators.required),\n    });\n    this.credentials = { password: \"\", username: \"\" };\n    const dateSys = new Date();\n    dateSys.toLocaleDateString('en-US');\n    \n    this.appLogsNew = {\n      eventType: \"Autenticacion\",\n      eventDescription:\n        \"Intento de autenticacion en el app administrador por: \" +\n        this.loginForm.get(\"usernameInput\")?.value,\n      eventDate: `Fecha: ${dateSys.getDate()}/${dateSys.getMonth()}/${dateSys.getFullYear()} Hora: ${dateSys.getHours()} ${dateSys.getMinutes()}`,\n    };\n  }\n\n  async GenerateAuth() {\n    this.appLogsService\n      .PostAppLogs(this.appLogsNew)\n      .subscribe((result: any) => {\n        console.log(result);\n      });\n\n    this.credentials = {\n      username: this.loginForm.get(\"usernameInput\")?.value,\n      password: this.loginForm.get(\"passwordInput\")?.value,\n    };\n\n    this.service.PostAuthorization(this.credentials).subscribe(\n      (result: any) => {\n        this.payload.pop();\n        this.payload.push(result);\n\n        localStorage.setItem(\"payload\", JSON.stringify(this.payload));\n        switch (this.payload[0].jwt) {\n          case \"USER NOT FOUND\":\n            alert(\n              \"THIS USER WAS NOT FOUND OR YOU ENTER BAD CREDENTIALS! PLEASE TRY AGAIN\"\n            );\n            break;\n          case \"NO AUTHORIZED\":\n            alert(\"BAD CREDENTIALS OR USER ACCOUNT INACTIVE, PLEASE TRY AGAIN\");\n            break;\n          default:\n            this.navigationApp.navigateByUrl(\"/Profile\");\n        }\n      },\n      (error: HttpErrorResponse) => {\n        alert(error.error.error.message);\n      }\n    );\n  }\n\n  ngOnInit(): void {}\n}\n","<div class=\"container bg-dark\">\n  <div class=\"row justify-content-center align-items-center vh-100\">\n    <div class=\"col-md-4\">\n      <div class=\"card\">\n        <div class=\"card-body\">\n          <h5 class=\"card-title mb-4\">Iniciar Sesión</h5>\n          <form [formGroup]=\"loginForm\" (ngSubmit)=\"GenerateAuth()\">\n            <div class=\"mb-3\">\n              <label for=\"username\" class=\"form-label\">Nombre de usuario</label>\n              <input\n                type=\"text\"\n                class=\"form-control\"\n                id=\"username\"\n                name=\"username\"\n                placeholder=\"Enter Username\"\n                formControlName=\"usernameInput\"\n                required=\"true\"\n              />\n            </div>\n            <div class=\"mb-3\">\n              <label for=\"password\" class=\"form-label\">Contraseña</label>\n              <input\n                type=\"password\"\n                class=\"form-control\"\n                id=\"password\"\n                name=\"password\"\n                placeholder=\"Enter Password\"\n                formControlName=\"passwordInput\"\n                required=\"true\"\n              />\n            </div>\n            <button type=\"submit\" class=\"btn btn-primary\" [disabled]=\"loginForm.invalid\">\n              Iniciar sesión\n            </button>\n          </form>\n        </div>\n      </div>\n    </div>\n  </div>\n \n</div>\n"]},"metadata":{},"sourceType":"module"}