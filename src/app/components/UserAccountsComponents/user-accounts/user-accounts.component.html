<app-menu></app-menu>

<div class="table-responsive">
  <table
    class="table table-striped table-hover table-borderless table-primary align-middle"
  >
    <thead class="table-light">
      <caption>
        Cuentas de usuario
      </caption>
      <tr>
        <th>Cedula</th>
        <th>Nombre</th>
        <th>Apellidos</th>
        <th>Telefono</th>
        <th>Correo Electronico</th>
        <th>Direccion</th>
        <th>Cuenta de Usuario</th>
        <th>Rol Actual</th>
        <th>Estado de la Cuenta</th>
        <th>Opciones</th>
      </tr>
    </thead>
    <tbody class="table-group-divider">
      <tr *ngFor="let item of userAccounts" class="table-primary">
        <td scope="row">{{ item._id }}</td>
        <td>{{ item.clientName }}</td>
        <td>{{ item.clientLastName }}</td>
        <td>{{ item.clientPhone }}</td>
        <td>{{ item.clientEmail }}</td>
        <td>{{ item.clientDirection }}</td>
        <td>{{ item.clientUsername }}</td>
        <td>{{ item.clientRoleType }}</td>
        <td>{{ item.userAccountActive ? "Activo" : "Inactivo" }}</td>
        <td>
          <!-- Button trigger modal -->
          <button
            type="button"
            class="btn btn-warning btn-lg"
            data-bs-toggle="modal"
            data-bs-target="#modalId"
            (click)="GetCurrentUserPayload(item)"
          >
            Editar
          </button>

          <!-- Modal -->
          <div
            class="modal fade"
            id="modalId"
            tabindex="-1"
            role="dialog"
            aria-labelledby="modalTitleId"
            aria-hidden="true"
          >
            <div
              class="modal-dialog modal-lg modal-fullscreen-md-down"
              role="document"
            >
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="modalTitleId">
                    Cuenta de Usuario {{ dynamicId }}
                  </h5>
                  <button
                    type="button"
                    class="btn-close"
                    data-bs-dismiss="modal"
                    aria-label="Close"
                  ></button>
                </div>
                <div class="modal-body">
                  <form
                    [formGroup]="updateAccountForm"
                    (ngSubmit)="UpdateCurrentUserAccount()"
                  >
                    <div class="row">
                      <div class="col-md-6">
                        <label for="InputCedulaEdit">Cedula</label>
                        <input
                          class="form-control"
                          readonly
                          type="text"
                          value="{{ dynamicId }}"
                        />
                      </div>
                    </div>
                    <hr />
                    <div class="row">
                      <div class="col-md-6">
                        <label for="InputNameEdit">Nombre</label>
                        <input
                          class="form-control"
                          type="text"
                          formControlName="InputName"
                        />
                      </div>
                      <div class="col-md-6">
                        <label for="InputApellidosEdit">Apellidos</label>
                        <input
                          class="form-control"
                          type="text"
                          formControlName="InputLastName"
                        />
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-6">
                        <label for="InputTelefonoEdit">Telefono</label>
                        <input
                          class="form-control"
                          type="tel"
                          formControlName="InputPhone"
                        />
                      </div>
                      <div class="col-md-6">
                        <label for="InputCorreoEdit">Correo Electronico</label>
                        <input
                          class="form-control"
                          type="email"
                          formControlName="InputEmail"
                        />
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-6">
                        <label for="InputDireccionEdit">Direccion Fisica</label>
                        <input
                        required
                          class="form-control"
                          type="text"
                          formControlName="InputDirection"
                        />
                      </div>
                      <div class="col-md-6">
                        <label for="InputCuentaEdit">Cuenta de Usuario</label>
                        <input
                        required
                          class="form-control"
                          type="text"
                          autocomplete="username"
                          formControlName="InputUserAccount"
                        />
                      </div>
                      <div class="col-md-6">
                        <label for="InputPasswordEdit">Contrase√±a Nueva</label>
                        <input
                        required
                          class="form-control"
                          type="password"
                          autocomplete="current-password"
                          required
                         
                          formControlName="InputPassword"
                        />
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-6">
                        <label for="InputRolEdit">Rol Actual</label>
                        <select
                        required
                          class="form-select"
                          
                         
                          formControlName="InputRolType"
                        >
                          <option selected>-- Seleccion --</option>
                          <option value="Administrator">Administrator</option>
                          <option value="Client">Client</option>
                        </select>
                      </div>
                      <div class="col-md-6">
                        <label for="InputEstadoEdit">Estado de la Cuenta</label>
                        <select
                          class="form-select"
                          required
                         
                          formControlName="InputActiveAccount"
                        >
                          <option value="" selected>-- Seleccion --</option>
                          <option value="Activo">Activo</option>
                          <option value="Inactivo">Inactivo</option>
                        </select>
                      </div>

                      <button
                        type="submit"
                        class="btn btn-success mt-3"
                        [disabled]="updateAccountForm.invalid"
                      >
                        Guardar Informacion
                      </button>
                      <button type="button" class="btn btn-danger mt-3" (click)="DeleteUserAccount()">
                        Eliminar Cuenta
                      </button>
                      
                      <div class="alert alert-success mt-3" role="alert" *ngIf="stateUpdateUserAccount">
                        <strong>Cuenta "{{userAccountName}}" actualizada</strong> 
                      </div>
                    </div>
                  </form>
                </div>
                <div class="modal-footer">

                 
                  
                  <button
                    type="button"
                    class="btn btn-secondary"
                    data-bs-dismiss="modal"
                    (click)="ShowAllUserAccounts()"
                  >
                    Cerrar Formulario
                  </button>
                </div>
              </div>
            </div>
          </div>
        </td>
      </tr>
    </tbody>
    <tfoot></tfoot>
  </table>
</div>
